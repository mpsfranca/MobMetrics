{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
    <title>MobMetrics</title>

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <link rel="stylesheet" href="{% static 'metrics/css/style.css' %}">
    <script src="https://cdn.plot.ly/plotly-latest.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
</head>
<body class="bg-light min-vh-100">
    {% include 'partials/header.html' %}

    <div class="container-fluid mt-5 pt-4">
        {% include 'partials/home.html' %}
        {% include 'partials/upload/upload_main.html' %}
        {% include 'partials/bonnmotion/bm_main.html' %}
        {% include 'partials/manage_files.html' %}
        {% include 'partials/results/results_main.html' %}
    </div>

    <script>
        const ACTIVE_TAB_KEY = "mobmetrics.activeTab";

        function showParams(model) {
            document.querySelectorAll('.model').forEach(m => {
                m.disabled = true
                m.classList.remove('d-block')
                m.classList.add('d-none')
            })
            
            let e = document.getElementById(model)
            e.disabled = false
            e.classList.add('d-block')
            e.classList.remove('d-none')
        }

        function switchTab(tabId) {
            // Save current tab so refresh restores it
            sessionStorage.setItem(ACTIVE_TAB_KEY, tabId); // [web:31]

            // This changes the style of the button if it is active
            document.querySelectorAll('.nav-link').forEach(c => {
                c.classList.remove('active', 'bg-primary', 'text-white')
                c.classList.add('bg-light', 'text-dark')
            })

            document.getElementById(`${tabId}-button`).classList.add('active', 'bg-primary', 'text-white');
            document.getElementById(`${tabId}-button`).classList.remove('bg-light', 'text-dark');

            // This shows the selected page's content
            document.querySelectorAll('.content').forEach(c => {
                if (c.id == tabId) {
                    c.classList.add('active', 'd-block')
                    c.classList.remove('d-none')
                } else {
                    c.classList.remove('active', 'd-block')
                    c.classList.add('d-none')
                }
            });
        }

        document.querySelector('form').addEventListener('submit', (e) => {
            const model = document.getElementById('model').value; // your select id

            document.querySelectorAll('fieldset.model').forEach(fs => fs.disabled = true);

            const active = document.getElementById(model);
            if (active) active.disabled = false;
        });

        document.addEventListener("DOMContentLoaded", () => {
            const savedTab = sessionStorage.getItem(ACTIVE_TAB_KEY); // [web:31]
            // Pick a safe default if nothing was saved yet
            const defaultTab = "home"; // change to your default tabId
            switchTab(savedTab ?? defaultTab);
        });

        // Enables Tooltips
        const tooltipTriggerList = document.querySelectorAll('[data-bs-toggle="tooltip"]')
        const tooltipList = [...tooltipTriggerList].map(tooltipTriggerEl => new bootstrap.Tooltip(tooltipTriggerEl))
    </script>

</body>
</html>
